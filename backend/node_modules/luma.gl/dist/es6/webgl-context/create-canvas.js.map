{"version":3,"sources":["../../../src/webgl-context/create-canvas.js"],"names":["isBrowser","isPage","document","isPageLoaded","readyState","pageLoadPromise","Promise","resolve","reject","window","onload","getPageLoadPromise","createCanvas","width","height","id","insert","canvas","createElement","style","Number","isFinite","body","insertBefore","firstChild","getCanvas","onError","targetCanvas","getElementById"],"mappings":"AAGA,SAAQA,SAAR,QAAwB,UAAxB;AAEA,MAAMC,MAAM,GAAGD,SAAS,IAAI,OAAOE,QAAP,KAAoB,WAAhD;AACA,IAAIC,YAAY,GAAGF,MAAM,IAAIC,QAAQ,CAACE,UAAT,KAAwB,UAArD;AAEA,OAAO,MAAMC,eAAe,GAAGJ,MAAM,GACnC,IAAIK,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC/B,MAAIL,YAAJ,EAAkB;AAChBI,IAAAA,OAAO,CAACL,QAAD,CAAP;AACA;AACD;;AACDO,EAAAA,MAAM,CAACC,MAAP,GAAgB,MAAM;AACpBP,IAAAA,YAAY,GAAG,IAAf;AACAI,IAAAA,OAAO,CAACL,QAAD,CAAP;AACD,GAHD;AAID,CATD,CADmC,GAWnCI,OAAO,CAACC,OAAR,CAAgB,EAAhB,CAXK;AAkBP,OAAO,SAASI,kBAAT,GAA8B;AACnC,SAAON,eAAP;AACD;AAOD,OAAO,SAASO,YAAT,CAAsB;AAACC,EAAAA,KAAK,GAAG,GAAT;AAAcC,EAAAA,MAAM,GAAG,GAAvB;AAA4BC,EAAAA,EAAE,GAAG,WAAjC;AAA8CC,EAAAA,MAAM,GAAG;AAAvD,CAAtB,EAAoF;AACzF,QAAMC,MAAM,GAAGf,QAAQ,CAACgB,aAAT,CAAuB,QAAvB,CAAf;AACAD,EAAAA,MAAM,CAACF,EAAP,GAAYA,EAAZ;AACAE,EAAAA,MAAM,CAACE,KAAP,CAAaN,KAAb,GAAqBO,MAAM,CAACC,QAAP,CAAgBR,KAAhB,IAA0B,GAAEA,KAAM,IAAlC,GAAwC,MAA7D;AACAI,EAAAA,MAAM,CAACE,KAAP,CAAaL,MAAb,GAAsBM,MAAM,CAACC,QAAP,CAAgBP,MAAhB,IAA2B,GAAEA,MAAO,IAApC,GAA0C,MAAhE;;AAEA,MAAIE,MAAJ,EAAY;AACV,UAAMM,IAAI,GAAGpB,QAAQ,CAACoB,IAAtB;AACAA,IAAAA,IAAI,CAACC,YAAL,CAAkBN,MAAlB,EAA0BK,IAAI,CAACE,UAA/B;AAED;;AACD,SAAOP,MAAP;AACD;AAED,OAAO,SAASQ,SAAT,CAAmB;AAACR,EAAAA,MAAD;AAASJ,EAAAA,KAAT;AAAgBC,EAAAA,MAAhB;AAAwBY,EAAAA,OAAO,GAAG,MAAM,CAAE;AAA1C,CAAnB,EAAgE;AACrE,MAAIC,YAAJ;;AACA,MAAI,OAAOV,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,QAAI,CAACd,YAAL,EAAmB;AACjBuB,MAAAA,OAAO,CAAE,qCAAoCT,MAAO,0BAA7C,CAAP;AACD;;AACDU,IAAAA,YAAY,GAAGzB,QAAQ,CAAC0B,cAAT,CAAwBX,MAAxB,CAAf;AACD,GALD,MAKO,IAAIA,MAAJ,EAAY;AACjBU,IAAAA,YAAY,GAAGV,MAAf;AACD,GAFM,MAEA;AACLU,IAAAA,YAAY,GAAGf,YAAY,CAAC;AAACG,MAAAA,EAAE,EAAE,eAAL;AAAsBF,MAAAA,KAAtB;AAA6BC,MAAAA,MAA7B;AAAqCY,MAAAA;AAArC,KAAD,CAA3B;AACD;;AAED,SAAOC,YAAP;AACD","sourcesContent":["// Resizing a webgl canvas\n\n/* global window, document */\nimport {isBrowser} from '../utils';\n\nconst isPage = isBrowser && typeof document !== 'undefined';\nlet isPageLoaded = isPage && document.readyState === 'complete';\n\nexport const pageLoadPromise = isPage ?\n  new Promise((resolve, reject) => {\n    if (isPageLoaded) {\n      resolve(document);\n      return;\n    }\n    window.onload = () => {\n      isPageLoaded = true;\n      resolve(document);\n    };\n  }) :\n  Promise.resolve({});\n\n/**\n * Returns a promise that resolves when the page is loaded\n * at this point the DOM can be manipulated, and e.g. a new canvas can be inserted\n * @return {Promise} - resolves when the page is loaded\n */\nexport function getPageLoadPromise() {\n  return pageLoadPromise;\n}\n\n/**\n * Create a canvas\n * @param {Number} width - set to 100%\n * @param {Number} height - set to 100%\n */\nexport function createCanvas({width = 800, height = 600, id = 'gl-canvas', insert = true}) {\n  const canvas = document.createElement('canvas');\n  canvas.id = id;\n  canvas.style.width = Number.isFinite(width) ? `${width}px` : '100%';\n  canvas.style.height = Number.isFinite(height) ? `${height}px` : '100%';\n  // add the canvas to the body element once the page has loaded\n  if (insert) {\n    const body = document.body;\n    body.insertBefore(canvas, body.firstChild);\n    // getPageLoadPromise().then(document => {});\n  }\n  return canvas;\n}\n\nexport function getCanvas({canvas, width, height, onError = () => {}}) {\n  let targetCanvas;\n  if (typeof canvas === 'string') {\n    if (!isPageLoaded) {\n      onError(`createGLContext called on canvas '${canvas}' before page was loaded`);\n    }\n    targetCanvas = document.getElementById(canvas);\n  } else if (canvas) {\n    targetCanvas = canvas;\n  } else {\n    targetCanvas = createCanvas({id: 'lumagl-canvas', width, height, onError});\n  }\n\n  return targetCanvas;\n}\n"],"file":"create-canvas.js"}