{"version":3,"sources":["../../../src/webgl/texture-3d.js"],"names":["isWebGL2","assertWebGL2Context","withParameters","Texture","Buffer","Texture3D","gl","opts","Object","assign","target","width","height","depth","seal","setImageData","generateMipmap","pixels","settings","setImage3D","setParameters","level","internalformat","border","format","type","offset","ArrayBuffer","isView","texImage3D","bindBuffer","handle"],"mappings":";;;;;;;;;;;;;;;;;;AACA,SAAQA,QAAR,EAAkBC,mBAAlB,QAA4C,gBAA5C;AACA,SAAQC,cAAR,QAA6B,gCAA7B;AACA,OAAOC,OAAP,MAAoB,kBAApB;AACA,OAAOC,MAAP,MAAmB,UAAnB;;IAEqBC,S;;;;;gCAEAC,E,EAAI;AACrB,aAAON,QAAQ,CAACM,EAAD,CAAf;AACD;;;AAcD,qBAAYA,EAAZ,EAA2B;AAAA;;AAAA,QAAXC,IAAW,uEAAJ,EAAI;;AAAA;;AACzBN,IAAAA,mBAAmB,CAACK,EAAD,CAAnB;AACA,mFAAMA,EAAN,EAAUE,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,IAAlB,EAAwB;AAACG,MAAAA,MAAM,EAAEH,IAAI,CAACG,MAAL;AAAT,KAAxB,CAAV;AAEA,UAAKC,KAAL,GAAa,IAAb;AACA,UAAKC,MAAL,GAAc,IAAd;AACA,UAAKC,KAAL,GAAa,IAAb;AACAL,IAAAA,MAAM,CAACM,IAAP;;AAEA,UAAKC,YAAL,CAAkBR,IAAlB;;AACA,QAAIA,IAAI,CAACS,cAAT,EAAyB;AACvB,YAAKA,cAAL;AACD;;AAZwB;AAa1B;;;;iCAEqB;AAAA;;AAAA,UAAXT,IAAW,uEAAJ,EAAI;AACpB,WAAKA,IAAL,GAAYC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB,KAAKF,IAAvB,EAA6BA,IAA7B,CAAZ;AADoB,uBAEO,KAAKA,IAFZ;AAAA,UAEbU,MAFa,cAEbA,MAFa;AAAA,UAELC,QAFK,cAELA,QAFK;;AAGpB,UAAIA,QAAJ,EAAc;AACZhB,QAAAA,cAAc,CAACgB,QAAD,EAAW,YAAM;AAC7B,cAAID,MAAJ,EAAY;AACV,YAAA,MAAI,CAACE,UAAL,CAAgB,MAAI,CAACZ,IAArB;AACD;AACF,SAJa,CAAd;AAKA,aAAKa,aAAL,CAAmBb,IAAnB;AACD;AACF;;;qCAgBE;AAAA,4BAVDc,KAUC;AAAA,UAVDA,KAUC,2BAVO,CAUP;AAAA,qCATDC,cASC;AAAA,UATDA,cASC;AAAA,UARDX,KAQC,QARDA,KAQC;AAAA,UAPDC,MAOC,QAPDA,MAOC;AAAA,4BANDC,KAMC;AAAA,UANDA,KAMC,2BANO,CAMP;AAAA,6BALDU,MAKC;AAAA,UALDA,MAKC,4BALQ,CAKR;AAAA,UAJDC,MAIC,QAJDA,MAIC;AAAA,2BAHDC,IAGC;AAAA,UAHDA,IAGC;AAAA,6BAFDC,MAEC;AAAA,UAFDA,MAEC,4BAFQ,CAER;AAAA,UADDT,MACC,QADDA,MACC;;AACD,UAAIU,WAAW,CAACC,MAAZ,CAAmBX,MAAnB,CAAJ,EAAgC;AAC9B,aAAKX,EAAL,CAAQuB,UAAR,CACE,KAAKnB,MADP,EAEEW,KAFF,EAESC,cAFT,EAGEX,KAHF,EAGSC,MAHT,EAGiBC,KAHjB,EAGwBU,MAHxB,EAGgCC,MAHhC,EAGwCC,IAHxC,EAG8CR,MAH9C;AAIA;AACD;;AACD,UAAIA,MAAM,YAAYb,MAAtB,EAA8B;AAC5B,aAAKE,EAAL,CAAQwB,UAAR,QAA2Cb,MAAM,CAACc,MAAlD;AACA,aAAKzB,EAAL,CAAQuB,UAAR,CACE,KAAKnB,MADP,EAEEW,KAFF,EAESC,cAFT,EAGEX,KAHF,EAGSC,MAHT,EAGiBC,KAHjB,EAGwBU,MAHxB,EAGgCC,MAHhC,EAGwCC,IAHxC,EAG8CC,MAH9C;AAIA,aAAKpB,EAAL,CAAQwB,UAAR,QAA2Cb,MAAM,CAACc,MAAlD;AACD;AACF;;;;EA5EoC5B,O;;SAAlBE,S","sourcesContent":["import GL from '../constants';\nimport {isWebGL2, assertWebGL2Context} from '../webgl-utils';\nimport {withParameters} from '../webgl-context/context-state';\nimport Texture from '../webgl/texture';\nimport Buffer from './buffer';\n\nexport default class Texture3D extends Texture {\n\n  static isSupported(gl) {\n    return isWebGL2(gl);\n  }\n\n  /**\n   * @classdesc\n   * 3D WebGL Texture\n   * Note: Constructor will initialize your texture.\n   *\n   * @class\n   * @param {WebGLRenderingContext} gl - gl context\n   * @param {Image|ArrayBuffer|null} opts= - named options\n   * @param {Image|ArrayBuffer|null} opts.data= - buffer\n   * @param {GLint} width - width of texture\n   * @param {GLint} height - height of texture\n   */\n  constructor(gl, opts = {}) {\n    assertWebGL2Context(gl);\n    super(gl, Object.assign({}, opts, {target: opts.target || GL.TEXTURE_3D}));\n\n    this.width = null;\n    this.height = null;\n    this.depth = null;\n    Object.seal(this);\n\n    this.setImageData(opts);\n    if (opts.generateMipmap) {\n      this.generateMipmap();\n    }\n  }\n\n  initialize(opts = {}) {\n    this.opts = Object.assign({}, this.opts, opts);\n    const {pixels, settings} = this.opts;\n    if (settings) {\n      withParameters(settings, () => {\n        if (pixels) {\n          this.setImage3D(this.opts);\n        }\n      });\n      this.setParameters(opts);\n    }\n  }\n\n  // WebGL2\n\n  // Image 3D copies from Typed Array or WebGLBuffer\n  setImage3D({\n    level = 0,\n    internalformat = GL.RGBA,\n    width,\n    height,\n    depth = 1,\n    border = 0,\n    format,\n    type = GL.UNSIGNED_BYTE,\n    offset = 0,\n    pixels\n  }) {\n    if (ArrayBuffer.isView(pixels)) {\n      this.gl.texImage3D(\n        this.target,\n        level, internalformat,\n        width, height, depth, border, format, type, pixels);\n      return;\n    }\n    if (pixels instanceof Buffer) {\n      this.gl.bindBuffer(GL.PIXEL_UNPACK_BUFFER, pixels.handle);\n      this.gl.texImage3D(\n        this.target,\n        level, internalformat,\n        width, height, depth, border, format, type, offset);\n      this.gl.bindBuffer(GL.PIXEL_UNPACK_BUFFER, pixels.handle);\n    }\n  }\n}\n"],"file":"texture-3d.js"}