{"version":3,"sources":["../../src/matrix3.js"],"names":["MathArray","Vector2","Vector3","mat3_determinant","mat3_transpose","mat3_invert","mat3_multiply","mat3_rotate","mat3_scale","mat3_translate","vec2_transformMat4","vec3_transformMat4","vec4_transformMat4","IDENTITY","validateMatrix3","m","length","Number","isFinite","tempVector4","Matrix3","constructor","args","Array","isArray","arguments","copy","identity","ELEMENTS","setRowMajor","m00","m10","m20","m01","m11","m21","m02","m12","m22","set","setColumnMajor","m30","m31","m32","check","determinant","i","transpose","invert","multiplyLeft","a","multiplyRight","rotateAxis","radians","axis","scale","vec","translate","transformVector2","vector","out","transformVector3","transformVector","Error","transformDirection"],"mappings":"AAoBA,OAAOA,SAAP,MAAsB,kBAAtB;AAEA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,OAAP,MAAoB,WAApB;AAOA,OAAOC,gBAAP,MAA6B,qBAA7B;AACA,OAAOC,cAAP,MAA2B,mBAA3B;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AAIA,OAAOC,WAAP,MAAwB,gBAAxB;AACA,OAAOC,UAAP,MAAuB,eAAvB;AACA,OAAOC,cAAP,MAA2B,mBAA3B;AACA,OAAOC,kBAAP,MAA+B,uBAA/B;AACA,OAAOC,kBAAP,MAA+B,uBAA/B;AACA,OAAOC,kBAAP,MAA+B,uBAA/B;AAEA,MAAMC,QAAQ,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAAjB;AAEA,OAAO,SAASC,eAAT,CAAyBC,CAAzB,EAA4B;AACjC,SACEA,CAAC,CAACC,MAAF,KAAa,EAAb,IACAC,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CADA,IAEAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CAFA,IAGAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CAHA,IAIAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CAJA,IAKAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CALA,IAMAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CANA,IAOAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CAPA,IAQAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CARA,IASAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CATA,IAUAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,CAAD,CAAjB,CAVA,IAWAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,EAAD,CAAjB,CAXA,IAYAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,EAAD,CAAjB,CAZA,IAaAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,EAAD,CAAjB,CAbA,IAcAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,EAAD,CAAjB,CAdA,IAeAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,EAAD,CAAjB,CAfA,IAgBAE,MAAM,CAACC,QAAP,CAAgBH,CAAC,CAAC,EAAD,CAAjB,CAjBF;AAmBD;AAED,MAAMI,WAAW,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAApB;AAEA,eAAe,MAAMC,OAAN,SAAsBpB,SAAtB,CAAgC;AAC7CqB,EAAAA,WAAW,CAAC,GAAGC,IAAJ,EAAU;AACnB;;AACA,QAAIC,KAAK,CAACC,OAAN,CAAcF,IAAI,CAAC,CAAD,CAAlB,KAA0BG,SAAS,CAACT,MAAV,KAAqB,CAAnD,EAAsD;AACpD,WAAKU,IAAL,CAAUJ,IAAI,CAAC,CAAD,CAAd;AACD,KAFD,MAEO;AACL,WAAKK,QAAL;AACD;AACF;;AAED,MAAIC,QAAJ,GAAe;AACb,WAAO,CAAP;AACD;;AAGDC,EAAAA,WAAW,CAACC,GAAG,GAAG,CAAP,EAAUC,GAAG,GAAG,CAAhB,EAAmBC,GAAG,GAAG,CAAzB,EAA4BC,GAAG,GAAG,CAAlC,EAAqCC,GAAG,GAAG,CAA3C,EAA8CC,GAAG,GAAG,CAApD,EAAuDC,GAAG,GAAG,CAA7D,EAAgEC,GAAG,GAAG,CAAtE,EAAyEC,GAAG,GAAG,CAA/E,EAAkF;AAC3F,WAAO,KAAKC,GAAL,CAAST,GAAT,EAAcG,GAAd,EAAmBG,GAAnB,EAAwBL,GAAxB,EAA6BG,GAA7B,EAAkCG,GAAlC,EAAuCL,GAAvC,EAA4CG,GAA5C,EAAiDG,GAAjD,CAAP;AACD;;AAEDE,EAAAA,cAAc,CAACV,GAAG,GAAG,CAAP,EAAUG,GAAG,GAAG,CAAhB,EAAmBG,GAAG,GAAG,CAAzB,EAA4BL,GAAG,GAAG,CAAlC,EAAqCG,GAAG,GAAG,CAA3C,EAA8CG,GAAG,GAAG,CAApD,EAAuDL,GAAG,GAAG,CAA7D,EAAgEG,GAAG,GAAG,CAAtE,EAAyEG,GAAG,GAAG,CAA/E,EAAkF;AAC9F,WAAO,KAAKC,GAAL,CAAST,GAAT,EAAcG,GAAd,EAAmBG,GAAnB,EAAwBL,GAAxB,EAA6BG,GAA7B,EAAkCG,GAAlC,EAAuCL,GAAvC,EAA4CG,GAA5C,EAAiDG,GAAjD,CAAP;AACD;;AAEDC,EAAAA,GAAG,CAACT,GAAD,EAAMG,GAAN,EAAWG,GAAX,EAAgBL,GAAhB,EAAqBG,GAArB,EAA0BG,GAA1B,EAA+BL,GAA/B,EAAoCG,GAApC,EAAyCG,GAAzC,EAA8CG,GAA9C,EAAmDC,GAAnD,EAAwDC,GAAxD,EAA6D;AAC9D,SAAK,CAAL,IAAUb,GAAV;AACA,SAAK,CAAL,IAAUG,GAAV;AACA,SAAK,CAAL,IAAUG,GAAV;AACA,SAAK,CAAL,IAAUL,GAAV;AACA,SAAK,CAAL,IAAUG,GAAV;AACA,SAAK,CAAL,IAAUG,GAAV;AACA,SAAK,CAAL,IAAUL,GAAV;AACA,SAAK,CAAL,IAAUG,GAAV;AACA,SAAK,EAAL,IAAWG,GAAX;AACA,SAAK,EAAL,IAAWG,GAAX;AACA,SAAK,EAAL,IAAWC,GAAX;AACA,SAAK,EAAL,IAAWC,GAAX;AACA,WAAO,KAAKC,KAAL,EAAP;AACD;;AAeDC,EAAAA,WAAW,GAAG;AACZ,WAAO1C,gBAAgB,CAAC,IAAD,CAAvB;AACD;;AAIDwB,EAAAA,QAAQ,GAAG;AACT,SAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGjC,QAAQ,CAACG,MAA7B,EAAqC,EAAE8B,CAAvC,EAA0C;AACxC,WAAKA,CAAL,IAAUjC,QAAQ,CAACiC,CAAD,CAAlB;AACD;;AACD,WAAO,KAAKF,KAAL,EAAP;AACD;;AAIDG,EAAAA,SAAS,GAAG;AACV3C,IAAAA,cAAc,CAAC,IAAD,EAAO,IAAP,CAAd;AACA,WAAO,KAAKwC,KAAL,EAAP;AACD;;AAEDI,EAAAA,MAAM,GAAG;AACP3C,IAAAA,WAAW,CAAC,IAAD,EAAO,IAAP,CAAX;AACA,WAAO,KAAKuC,KAAL,EAAP;AACD;;AAIDK,EAAAA,YAAY,CAACC,CAAD,EAAI;AACd5C,IAAAA,aAAa,CAAC,IAAD,EAAO4C,CAAP,EAAU,IAAV,CAAb;AACA,WAAO,KAAKN,KAAL,EAAP;AACD;;AAEDO,EAAAA,aAAa,CAACD,CAAD,EAAI;AACf5C,IAAAA,aAAa,CAAC,IAAD,EAAO,IAAP,EAAa4C,CAAb,CAAb;AACA,WAAO,KAAKN,KAAL,EAAP;AACD;;AA6BDQ,EAAAA,UAAU,CAACC,OAAD,EAAUC,IAAV,EAAgB;AACxB/C,IAAAA,WAAW,CAAC,IAAD,EAAO,IAAP,EAAa8C,OAAb,EAAsBC,IAAtB,CAAX;AACA,WAAO,KAAKV,KAAL,EAAP;AACD;;AAEDW,EAAAA,KAAK,CAACC,GAAD,EAAM;AACThD,IAAAA,UAAU,CAAC,IAAD,EAAO,IAAP,EAAagD,GAAb,CAAV;AACA,WAAO,KAAKZ,KAAL,EAAP;AACD;;AAEDa,EAAAA,SAAS,CAACD,GAAD,EAAM;AACb/C,IAAAA,cAAc,CAAC,IAAD,EAAO,IAAP,EAAa+C,GAAb,CAAd;AACA,WAAO,KAAKZ,KAAL,EAAP;AACD;;AAEDc,EAAAA,gBAAgB,CAACC,MAAD,EAASC,GAAT,EAAc;AAC5BA,IAAAA,GAAG,GAAGA,GAAG,IAAI,IAAI3D,OAAJ,EAAb;AACAS,IAAAA,kBAAkB,CAACkD,GAAD,EAAMD,MAAN,EAAc,IAAd,CAAlB;AAEA,WAAOC,GAAP;AACD;;AAEDC,EAAAA,gBAAgB,CAACF,MAAD,EAASC,GAAG,GAAG,IAAI1D,OAAJ,EAAf,EAA8B;AAC5C0D,IAAAA,GAAG,GAAGA,GAAG,IAAI,IAAI1D,OAAJ,EAAb;AACAS,IAAAA,kBAAkB,CAACiD,GAAD,EAAMD,MAAN,EAAc,IAAd,CAAlB;AAEA,WAAOC,GAAP;AACD;;AAWDE,EAAAA,eAAe,CAACH,MAAD,EAASC,GAAT,EAAc;AAC3B,YAAQD,MAAM,CAAC3C,MAAf;AACE,WAAK,CAAL;AACE,eAAO,KAAK0C,gBAAL,CAAsBC,MAAtB,EAA8BC,GAA9B,CAAP;;AACF,WAAK,CAAL;AACE,eAAO,KAAKC,gBAAL,CAAsBF,MAAtB,EAA8BC,GAA9B,CAAP;;AAGF;AACE,cAAM,IAAIG,KAAJ,CAAU,gBAAV,CAAN;AARJ;AAUD;;AAEDC,EAAAA,kBAAkB,CAACL,MAAD,EAASC,GAAT,EAAc;AAC9B,YAAQD,MAAM,CAAC3C,MAAf;AACE,WAAK,CAAL;AACEJ,QAAAA,kBAAkB,CAACO,WAAD,EAAc,CAACwC,MAAM,CAAC,CAAD,CAAP,EAAYA,MAAM,CAAC,CAAD,CAAlB,EAAuB,CAAvB,EAA0B,CAA1B,CAAd,EAA4C,IAA5C,CAAlB;AACAC,QAAAA,GAAG,GAAGA,GAAG,IAAI,IAAI3D,OAAJ,EAAb;AACC2D,QAAAA,GAAG,CAAC,CAAD,CAHN,GAGqBzC,WAHrB;AAGWyC,QAAAA,GAAG,CAAC,CAAD,CAHd,GAGqBzC,WAHrB;AAIE;;AACF,WAAK,CAAL;AACEP,QAAAA,kBAAkB,CAACO,WAAD,EAAc,CAACwC,MAAM,CAAC,CAAD,CAAP,EAAYA,MAAM,CAAC,CAAD,CAAlB,EAAuBA,MAAM,CAAC,CAAD,CAA7B,EAAkC,CAAlC,CAAd,EAAoD,IAApD,CAAlB;AACAC,QAAAA,GAAG,GAAGA,GAAG,IAAI,IAAI1D,OAAJ,EAAb;AACC0D,QAAAA,GAAG,CAAC,CAAD,CAHN,GAG6BzC,WAH7B;AAGWyC,QAAAA,GAAG,CAAC,CAAD,CAHd,GAG6BzC,WAH7B;AAGmByC,QAAAA,GAAG,CAAC,CAAD,CAHtB,GAG6BzC,WAH7B;AAIE;;AAMF;AACE,cAAM,IAAI4C,KAAJ,CAAU,gBAAV,CAAN;AAjBJ;;AAmBA,WAAOH,GAAP;AACD;;AA5L4C","sourcesContent":["// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport MathArray from './lib/math-array';\n// import {checkNumber} from './lib/common';\nimport Vector2 from './vector2';\nimport Vector3 from './vector3';\n// import Vector2, {validateVector2} from './vector2';\n// import Vector3, {validateVector3} from './vector3';\n// import assert from 'assert';\n\n// gl-matrix is too big. Cherry-pick individual imports from stack.gl version\n/* eslint-disable camelcase */\nimport mat3_determinant from 'gl-mat3/determinant';\nimport mat3_transpose from 'gl-mat3/transpose';\nimport mat3_invert from 'gl-mat3/invert';\nimport mat3_multiply from 'gl-mat3/multiply';\n// import mat3_rotateX from 'gl-mat3/rotateX';\n// import mat3_rotateY from 'gl-mat3/rotateY';\n// import mat3_rotateZ from 'gl-mat3/rotateZ';\nimport mat3_rotate from 'gl-mat3/rotate';\nimport mat3_scale from 'gl-mat3/scale';\nimport mat3_translate from 'gl-mat3/translate';\nimport vec2_transformMat4 from 'gl-vec2/transformMat4';\nimport vec3_transformMat4 from 'gl-vec3/transformMat4';\nimport vec4_transformMat4 from 'gl-vec4/transformMat4';\n\nconst IDENTITY = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n\nexport function validateMatrix3(m) {\n  return (\n    m.length === 16 &&\n    Number.isFinite(m[0]) &&\n    Number.isFinite(m[1]) &&\n    Number.isFinite(m[2]) &&\n    Number.isFinite(m[3]) &&\n    Number.isFinite(m[4]) &&\n    Number.isFinite(m[5]) &&\n    Number.isFinite(m[6]) &&\n    Number.isFinite(m[7]) &&\n    Number.isFinite(m[8]) &&\n    Number.isFinite(m[9]) &&\n    Number.isFinite(m[10]) &&\n    Number.isFinite(m[11]) &&\n    Number.isFinite(m[12]) &&\n    Number.isFinite(m[13]) &&\n    Number.isFinite(m[14]) &&\n    Number.isFinite(m[15])\n  );\n}\n\nconst tempVector4 = [0, 0, 0, 0];\n\nexport default class Matrix3 extends MathArray {\n  constructor(...args) {\n    super();\n    if (Array.isArray(args[0]) && arguments.length === 1) {\n      this.copy(args[0]);\n    } else {\n      this.identity();\n    }\n  }\n\n  get ELEMENTS() {\n    return 9;\n  }\n\n  /* eslint-disable max-params */\n  setRowMajor(m00 = 1, m10 = 0, m20 = 0, m01 = 0, m11 = 1, m21 = 0, m02 = 0, m12 = 0, m22 = 1) {\n    return this.set(m00, m01, m02, m10, m11, m12, m20, m21, m22);\n  }\n\n  setColumnMajor(m00 = 1, m01 = 0, m02 = 0, m10 = 0, m11 = 1, m12 = 0, m20 = 0, m21 = 0, m22 = 1) {\n    return this.set(m00, m01, m02, m10, m11, m12, m20, m21, m22);\n  }\n\n  set(m00, m01, m02, m10, m11, m12, m20, m21, m22, m30, m31, m32) {\n    this[0] = m00;\n    this[1] = m01;\n    this[2] = m02;\n    this[4] = m10;\n    this[5] = m11;\n    this[6] = m12;\n    this[8] = m20;\n    this[9] = m21;\n    this[10] = m22;\n    this[12] = m30;\n    this[13] = m31;\n    this[14] = m32;\n    return this.check();\n  }\n  /* eslint-enable max-params */\n\n  // toString() {\n  //   if (config.printRowMajor) {\n  //     mat3_str(this);\n  //   } else {\n  //     mat3_str(this);\n  //   }\n  // }\n\n  /* eslint-enable no-multi-spaces, brace-style, no-return-assign */\n\n  // Accessors\n\n  determinant() {\n    return mat3_determinant(this);\n  }\n\n  // Constructors\n\n  identity() {\n    for (let i = 0; i < IDENTITY.length; ++i) {\n      this[i] = IDENTITY[i];\n    }\n    return this.check();\n  }\n\n  // Modifiers\n\n  transpose() {\n    mat3_transpose(this, this);\n    return this.check();\n  }\n\n  invert() {\n    mat3_invert(this, this);\n    return this.check();\n  }\n\n  // Operations\n\n  multiplyLeft(a) {\n    mat3_multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a) {\n    mat3_multiply(this, this, a);\n    return this.check();\n  }\n\n  // Rotates a matrix by the given angle around the X axis\n  // rotateX(radians) {\n  //   mat3_rotateX(this, this, radians);\n  //   this.check();\n  //   return this;\n  // }\n\n  // Rotates a matrix by the given angle around the Y axis.\n  // rotateY(radians) {\n  //   mat3_rotateY(this, this, radians);\n  //   this.check();\n  //   return this;\n  // }\n\n  // Rotates a matrix by the given angle around the Z axis.\n  // rotateZ(radians) {\n  //   mat3_rotateZ(this, this, radians);\n  //   this.check();\n  //   return this;\n  // }\n\n  // rotateXYZ([rx, ry, rz]) {\n  //   return this.rotateX(rx)\n  //     .rotateY(ry)\n  //     .rotateZ(rz);\n  // }\n\n  rotateAxis(radians, axis) {\n    mat3_rotate(this, this, radians, axis);\n    return this.check();\n  }\n\n  scale(vec) {\n    mat3_scale(this, this, vec);\n    return this.check();\n  }\n\n  translate(vec) {\n    mat3_translate(this, this, vec);\n    return this.check();\n  }\n\n  transformVector2(vector, out) {\n    out = out || new Vector2();\n    vec2_transformMat4(out, vector, this);\n    // assert(validateVector2(out));\n    return out;\n  }\n\n  transformVector3(vector, out = new Vector3()) {\n    out = out || new Vector3();\n    vec3_transformMat4(out, vector, this);\n    // assert(validateVector3(out));\n    return out;\n  }\n\n  // transformVector4(vector, out = new Vector4()) {\n  //   out = out || new Vector4();\n  //   vec4_transformMat4(out, vector, this);\n  //   assert(validateVector4(out));\n  //   return out;\n  // }\n\n  // Transforms any 2, 3 or 4 element vector\n  // returns a newly minted Vector2, Vector3 or Vector4\n  transformVector(vector, out) {\n    switch (vector.length) {\n      case 2:\n        return this.transformVector2(vector, out);\n      case 3:\n        return this.transformVector3(vector, out);\n      // case 4:\n      //   return this.transformVector4(vector, out);\n      default:\n        throw new Error('Illegal vector');\n    }\n  }\n\n  transformDirection(vector, out) {\n    switch (vector.length) {\n      case 2:\n        vec4_transformMat4(tempVector4, [vector[0], vector[1], 0, 0], this);\n        out = out || new Vector2();\n        [out[0], out[1]] = tempVector4;\n        break;\n      case 3:\n        vec4_transformMat4(tempVector4, [vector[0], vector[1], vector[2], 0], this);\n        out = out || new Vector3();\n        [out[0], out[1], out[2]] = tempVector4;\n        break;\n      // case 4:\n      //   assert(vector[3] === 0);\n      //   out = out || new Vector4();\n      //   vec4_transformMat4(out, vector, this);\n      //   break;\n      default:\n        throw new Error('Illegal vector');\n    }\n    return out;\n  }\n\n  // transformPoint(vector, out) {\n  //   switch (vector.length) {\n  //     case 2:\n  //       out = out || new Vector2();\n  //       vec4_transformMat4(out, [vector[0], vector[1], 0, 1], this);\n  //       out.length = 2;\n  //       assert(validateVector2(out));\n  //       break;\n  //     case 3:\n  //       out = out || new Vector3();\n  //       vec4_transformMat4(out, [vector[0], vector[1], vector[2], 1], this);\n  //       out.length = 3;\n  //       assert(validateVector3(out));\n  //       break;\n  //     case 4:\n  //       assert(vector[3] !== 0);\n  //       out = out || new Vector4();\n  //       vec4_transformMat4(out, vector, this);\n  //       assert(validateVector4(out));\n  //       break;\n  //     default:\n  //       throw new Error('Illegal vector');\n  //   }\n  //   return out;\n  // }\n}\n"],"file":"matrix3.js"}